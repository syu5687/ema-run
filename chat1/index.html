<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ihg Best Match | ãƒ•ã‚©ãƒ¼ãƒ â†’ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆåŒ–ï¼ˆv1.6 åˆæœŸã¯é–‰ã˜ãŸçŠ¶æ…‹ãƒ»å†é–‹å¯ï¼‰</title>
  <style>
	:root{
	  --teal:#14919b;
	  --teal-dark:#0f6f78;
	  --header:#083344;
	}
	body { font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP",Helvetica,Arial,sans-serif; }

	.chat-launcher-bar{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);display:flex;align-items:center;gap:10px;background:var(--teal);color:#fff;border-radius:10px;padding:12px 16px;box-shadow:0 10px 24px rgba(0,0,0,.25);z-index:2147483640;cursor:pointer;min-width:320px;width:fit-content;}
	.chat-launcher-bar .icon{font-size:20px;line-height:1}
	.chat-launcher-bar .label{font-weight:600;letter-spacing:.02em}
	.chat-launcher-bar .chev{margin-left:6px;opacity:.9;transition:transform .2s ease;display:inline-block}
	.chat-launcher-bar[aria-expanded="true"] .chev{transform:rotate(180deg);}
	@media (max-width:640px){
	  .chat-launcher-bar{left:0;right:0;bottom:0;transform:none;border-radius:0;justify-content:center;width:100%;padding:14px 18px;}
	}

	.chat-widget{position:fixed;right:20px;bottom:96px;width:min(420px, calc(100vw - 40px));height:70vh;max-height:620px;border-radius:16px;box-shadow:0 20px 40px rgba(0,0,0,.25);background:#fff;display:none;flex-direction:column;overflow:hidden;z-index:2147483001;}
	.chat-widget.open{display:flex}
	.chat-header{padding:14px 16px;background:var(--header);color:#fff;display:flex;align-items:center;justify-content:space-between}
	.chat-header .title{font-weight:700}
	.chat-header .close{background:transparent;border:0;color:#fff;font-size:20px;cursor:pointer}
	.chat-body{padding:12px;gap:8px;display:flex;flex-direction:column;overflow-y:auto;background:#f8fafc}
	.sys,.user{max-width:86%;padding:10px 12px;border-radius:14px;font-size:14px;white-space:pre-wrap}
	.sys{background:#e2f0f6;align-self:flex-start}
	.user{background:#fff;align-self:flex-end;border:1px solid #e5e7eb}
	.chat-footer{padding:10px;display:grid;grid-template-columns:1fr auto;gap:8px;background:#fff}
	.chat-footer input{padding:10px 12px;border:1px solid #cbd5e1;border-radius:10px;font-size:14px}
	.chat-footer button{padding:10px 14px;border:0;border-radius:10px;background:var(--teal);color:#fff;cursor:pointer}
	.loading-overlay{position:absolute;inset:0;background:rgba(255,255,255,0.85);display:none;align-items:center;justify-content:center;z-index:10}
	.loading-overlay.active{display:flex}
	.loading-spinner{width:48px;height:48px;border:4px solid var(--teal);border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite}
	@keyframes spin{to{transform:rotate(360deg)}}

	.choices{display:flex;flex-wrap:wrap;gap:6px 8px}
	.pill{display:inline-block;margin:4px 0 0 0;padding:6px 12px;font-size:14px;border:1px solid #cbd5e1;border-radius:20px;background:#fff;cursor:pointer}
	.pill.selected{background:#2563eb;color:#fff;border-color:#2563eb}
	.confirm-pill{border:1px solid #2563eb;background:#fff;color:#2563eb}
	.confirm-pill.active{background:#2563eb;color:#fff;border-color:#2563eb;animation:pulse 1s ease-in-out infinite}
	@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(37,99,235,.55)}50%{box-shadow:0 0 0 8px rgba(37,99,235,0)}}

	@media (max-width:640px){
	  .chat-widget{right:0;bottom:0;left:0;top:0;width:100vw;height:100vh;max-height:none;border-radius:0}
	}
  </style>
<link rel="icon" href="data:,">
</head>
<body>
  <div class="chat-launcher-bar" id="launcherBar" role="button" tabindex="0" aria-controls="chatWidget" aria-expanded="false">
	<span class="icon">ğŸ’¬</span>
	<span class="label">ã”ç›¸è«‡ãƒãƒ£ãƒƒãƒˆ</span>
	<span class="chev">â–´</span>
  </div>

  <section class="chat-widget" id="chatWidget" role="dialog" aria-label="ã”ç›¸è«‡ãƒãƒ£ãƒƒãƒˆ">
	<div class="chat-header"><span class="title">ã”ç›¸è«‡ãƒãƒ£ãƒƒãƒˆ</span><button class="close" id="chatClose" aria-label="é–‰ã˜ã‚‹">Ã—</button></div>
	<div class="chat-body" id="chat"></div>
	<div class="chat-footer">
	  <input id="textInput" placeholder="ã“ã“ã«å…¥åŠ›â€¦" />
	  <button id="sendBtn" type="button">é€ä¿¡</button>
	</div>
	<div id="loadingOverlay" class="loading-overlay"><div class="loading-spinner"></div></div>
  </section>

  <script>
  (function(){
	const FLOW = [
	  { key: 'visited_before', label: 'å½“é¤¨ã«ãŠè¶Šã—ã„ãŸã ã„ãŸã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', type: 'singleChoice', options: ['ãªã—','ã‚ã‚‹ï¼ˆçµå©šå¼ï¼‰','ã‚ã‚‹ï¼ˆå®´ä¼šï¼‰'] },
	  { key: 'tour_status', label: 'å¼å ´è¦‹å­¦çŠ¶æ³ã¯ï¼Ÿ', type: 'singleChoice', options: ['åˆã‚ã¦','2å¼å ´ç›®','3å¼å ´ç›®','4å¼å ´ä»¥ä¸Š'] },
	  { key: 'ceremony_style', label: 'æŒ™å¼ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆè¤‡æ•°å¯ï¼‰', type: 'multiChoice', options: ['ãƒãƒ£ãƒšãƒ«æŒ™å¼','äººå‰å¼ï¼ˆãƒãƒ£ãƒšãƒ«å†…ãƒ»ä¼šå ´å†…ï¼‰','ç¥å‰å¼','ã”æŠ«éœ²å®´ã®ã¿','ãã®ä»–'] },
	  { key: 'guest_counts_groom', label: 'ã”äºˆå®šäººæ•°ï¼ˆæ–°éƒå´ï¼‰', type: 'text' },
	  { key: 'guest_counts_bride', label: 'ã”äºˆå®šäººæ•°ï¼ˆæ–°å©¦å´ï¼‰', type: 'text' },
	  { key: 'season_preference', label: 'ã”å¸Œæœ›ã®æ™‚æœŸã‚’é¸æŠã—ã¦ãã ã•ã„', type: 'singleChoice', options: ['æ˜¥','å¤','ç§‹','å†¬','æœªå®š'] },
	  { key: 'time_band', label: 'æ™‚é–“å¸¯ã®ã”å¸Œæœ›', type: 'singleChoice', options: ['æ˜¼é£Ÿã«ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’åˆã‚ã›ãŸã„','å¤•é£Ÿã«ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’åˆã‚ã›ãŸã„'] },
	  { key: 'costume', label: 'è¡£è£³ï¼ˆè¤‡æ•°å¯ï¼‰', type: 'multiChoice', options: ['ã‚¦ã‚§ãƒ‡ã‚£ãƒ³ã‚°ãƒ‰ãƒ¬ã‚¹','ã‚«ã‚¯ãƒ†ãƒ«ãƒ‰ãƒ¬ã‚¹','ç™½ç„¡å¢','è‰²æ‰“æ›','ã‚¿ã‚­ã‚·ãƒ¼ãƒ‰','ç´‹ä»˜è¢´'] },
	  { key: 'groom_name', label: 'æ–°éƒæ§˜ã®ãŠåå‰ï¼ˆä¾‹ï¼šä½è³€ å¤ªéƒï¼‰', type: 'text', required:true },
	  { key: 'bride_name', label: 'æ–°å©¦æ§˜ã®ãŠåå‰ï¼ˆä¾‹ï¼šä½è³€ èŠ±å­ï¼‰', type: 'text', required:true },
	  { key: 'phone', label: 'é›»è©±ç•ªå·ï¼ˆãƒã‚¤ãƒ•ãƒ³å¯ï¼‰', type: 'tel', required:true },
	  { key: 'email', label: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹', type: 'email', required:true },
	  { key: 'address', label: 'ã”ä½æ‰€ï¼ˆå¸‚åŒºç”ºæ‘ä»¥é™ï¼‰', type: 'text', required:true },
	  { key: 'has_kids', label: 'ãŠå­æ§˜ã¯ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã™ã‹ï¼Ÿ', type: 'singleChoice', options: ['ã‚ã‚Š','ãªã—'] },
	  { key: 'visit_1st', label: 'æ¥é¤¨å¸Œæœ›æ—¥ï¼ˆç¬¬1å¸Œæœ›ï¼‰ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„', type: 'date', required:true },
	  { key: 'visit_2nd', label: 'æ¥é¤¨å¸Œæœ›æ—¥ï¼ˆç¬¬2å¸Œæœ›ï¼‰ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„', type: 'date', required:true },
	  { key: 'consent', label: 'å€‹äººæƒ…å ±ä¿è­·æ–¹é‡ã«åŒæ„ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿã€ŒåŒæ„ã—ã¾ã™ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', type: 'consent', required:true }
	];

	const widget=document.getElementById('chatWidget');
	const launcher=document.getElementById('launcherBar');
	const closeBtn=document.getElementById('chatClose');
	const chat=document.getElementById('chat');
	const textInput=document.getElementById('textInput');
	const sendBtn=document.getElementById('sendBtn');
	const overlay=document.getElementById('loadingOverlay');
	const state={step:0,answers:{},busy:false,started:false};

	function bubble(txt,who='sys'){ const d=document.createElement('div'); d.className=who; d.textContent=txt; chat.appendChild(d); chat.scrollTop=chat.scrollHeight; }
	function todayISO(){ return new Date().toISOString().slice(0,10); }
	function showLoading(){ overlay.classList.add('active'); textInput.disabled=true; sendBtn.disabled=true; }
	function hideLoading(){ overlay.classList.remove('active'); textInput.disabled=false; sendBtn.disabled=false; }

	function renderChoices(q){
	  const wrap=document.createElement('div'); wrap.className='sys choices';
	  if(q.type==='singleChoice'){
		q.options.forEach(opt=>{ const b=document.createElement('button'); b.type='button'; b.className='pill'; b.textContent=opt; b.addEventListener('click',()=>handleAnswer(opt)); wrap.appendChild(b); });
	  } else { 
		const selected=new Set();
		q.options.forEach(opt=>{ const b=document.createElement('button'); b.type='button'; b.className='pill'; b.textContent=opt; b.addEventListener('click',()=>{ b.classList.toggle('selected'); if(b.classList.contains('selected')) selected.add(opt); else selected.delete(opt); updateConfirm(); }); wrap.appendChild(b); });
		const ok=document.createElement('button'); ok.type='button'; ok.className='pill confirm-pill'; ok.textContent='é¸æŠã‚’ç¢ºå®š';
		function updateConfirm(){ const n=selected.size; if(n>0){ ok.classList.add('active'); ok.textContent=`é¸æŠã‚’ç¢ºå®šï¼ˆ${n}ï¼‰`; } else { ok.classList.remove('active'); ok.textContent='é¸æŠã‚’ç¢ºå®š'; } }
		ok.addEventListener('click',()=>handleAnswer(Array.from(selected)));
		wrap.appendChild(ok); updateConfirm();
	  }
	  chat.appendChild(wrap); chat.scrollTop=chat.scrollHeight;
	}

	function start(){ state.started=true; bubble('ã”ç›¸è«‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã„ãã¤ã‹ã®è³ªå•ã«ãŠç­”ãˆãã ã•ã„ã€‚'); ask(); }

	function ask(){ if(state.step>=FLOW.length){ return finish(); } const q=FLOW[state.step]; bubble(`Q${state.step+1}ï¼š${q.label}`); if(q.type==='singleChoice'||q.type==='multiChoice') renderChoices(q); textInput.type=q.type==='date'?'date':(q.type==='email'?'email':(q.type==='tel'?'tel':'text')); textInput.value=''; if(q.type==='date'){ textInput.min=todayISO(); textInput.value=todayISO(); } }

	function handleAnswer(val){ if(state.busy) return; const q=FLOW[state.step]; const raw=(val!==undefined)? val : (textInput.value||'').trim(); if(q.required && (Array.isArray(raw)? raw.length===0 : !raw)){ bubble('å¿…é ˆå…¥åŠ›ã§ã™'); return; } bubble(Array.isArray(raw)? raw.join('ã€'):raw,'user'); state.answers[q.key]=raw; state.step++; state.busy=true; showLoading(); setTimeout(()=>{ hideLoading(); state.busy=false; ask(); },500); }

	function finish(){ bubble('ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼é€ä¿¡å‡¦ç†ã‚’è¡Œã„ã¾ã™â€¦'); showLoading(); setTimeout(()=>{ hideLoading(); bubble('é€ä¿¡ãŒå®Œäº†ã—ã¾ã—ãŸï¼'); },1000); }

	function openWidget(){ widget.classList.add('open'); launcher.setAttribute('aria-expanded','true'); if(!state.started){ start(); } }
	function closeWidget(){ widget.classList.remove('open'); launcher.setAttribute('aria-expanded','false'); }
	function toggleWidget(){ widget.classList.contains('open')? closeWidget(): openWidget(); }

	launcher.addEventListener('click',toggleWidget);
	launcher.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); toggleWidget(); }});
	closeBtn.addEventListener('click',closeWidget);
	document.addEventListener('keydown',e=>{ if(e.key==='Escape') closeWidget(); });
  })();
  </script>
<!-- v1.5: é–‹é–‰å®‰å®šãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæ–‡æ³•ã‚¨ãƒ©ãƒ¼ã‚’é¿ã‘ã‚‹ãŸã‚ç‹¬ç«‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ä¸Šæ›¸ãï¼‰ -->
<script>
(function(){
  function bind(){
	var launcher = document.getElementById('launcherBar');
	var widget   = document.getElementById('chatWidget');
	if(!launcher || !widget) return;
	function openWidget(){ widget.classList.add('open'); launcher.setAttribute('aria-expanded','true'); if(window.__startChat) try{ window.__startChat(); }catch(e){} }
	function closeWidget(){ widget.classList.remove('open'); launcher.setAttribute('aria-expanded','false'); }
	function toggleWidget(){ widget.classList.contains('open') ? closeWidget() : openWidget(); }
	// å…¬é–‹
	window.toggleWidget = toggleWidget;
	// ãƒã‚¤ãƒ³ãƒ‰ï¼ˆé‡è¤‡ç™»éŒ²ã‚’é¿ã‘ã‚‹ãŸã‚ä¸€æ—¦æ—¢å­˜ã‚’è§£é™¤â†’å†ç™»éŒ²ï¼‰
	launcher.onclick = null;
	launcher.addEventListener('click', toggleWidget);
	launcher.addEventListener('keydown', function(e){ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); toggleWidget(); } });
	document.addEventListener('keydown', function(e){ if(e.key==='Escape') closeWidget(); });
  }
  if(document.readyState==='complete' || document.readyState==='interactive') bind();
  else document.addEventListener('DOMContentLoaded', bind, {once:true});
})();
</script>
<!-- v1.5.2: å¼·åˆ¶èµ·å‹•ï¼†ç©ºæ™‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€‚é–‰ã˜ãŸå¾Œã‚‚å¿…ãšå†ã‚ªãƒ¼ãƒ—ãƒ³ã§æ¡ˆå†…ï¼‹Q1ã‚’æç”» -->
<script>
(function(){
  function greetIfEmpty(){
	try{
	  var chat=document.getElementById('chat');
	  if(!chat) return;
	  if(chat.childElementCount===0){
		// ç›´æ¥æç”»ï¼ˆ__bubbleãŒç„¡ãã¦ã‚‚æœ€ä½é™è¡¨ç¤ºï¼‰
		var d=document.createElement('div'); d.className='sys'; d.textContent='ã”ç›¸è«‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ã„ãã¤ã‹ã®è³ªå•ã«ãŠç­”ãˆãã ã•ã„ã€‚'; chat.appendChild(d); chat.scrollTop=chat.scrollHeight;
		if(window.__ask) try{ window.__ask(); }catch(e){}
	  }
	}catch(e){ console && console.warn && console.warn(e); }
  }
  function openNow(){
	var launcher=document.getElementById('launcherBar');
	var widget=document.getElementById('chatWidget');
	if(widget){ widget.classList.add('open'); if(launcher) launcher.setAttribute('aria-expanded','true'); }
	if(window.__startChat) try{ window.__startChat(); }catch(e){}
	greetIfEmpty();
  }
  // åˆå›ã¯é–‰ã˜ãŸã¾ã¾ã«ã™ã‚‹ï¼ˆè‡ªå‹•ã‚ªãƒ¼ãƒ—ãƒ³åœæ­¢ï¼‰
  function boot(){ /* ä½•ã‚‚ã—ãªã„ */ }
  if(document.readyState==='complete' || document.readyState==='interactive') boot();
  else document.addEventListener('DOMContentLoaded', boot, {once:true});

  // ãƒ©ãƒ³ãƒãƒ£ãƒ¼å†é–‹æ™‚ã‚‚ä¿é™º
  function bind(){
	var launcher=document.getElementById('launcherBar');
	var widget=document.getElementById('chatWidget');
	if(!launcher||!widget) return;
	function openWidget(){ widget.classList.add('open'); launcher.setAttribute('aria-expanded','true'); if(window.__startChat) try{ window.__startChat(); }catch(e){} greetIfEmpty(); }
	function closeWidget(){ widget.classList.remove('open'); launcher.setAttribute('aria-expanded','false'); }
	function toggleWidget(){ widget.classList.contains('open') ? closeWidget() : openWidget(); }
	launcher.onclick = null; // æ—¢å­˜ã‚’è§£é™¤
	launcher.addEventListener('click', toggleWidget);
	launcher.addEventListener('keydown', function(e){ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); toggleWidget(); } });
	document.addEventListener('keydown', function(e){ if(e.key==='Escape') closeWidget(); });
	window.toggleWidget = toggleWidget;
  }
  if(document.readyState==='complete' || document.readyState==='interactive') bind();
  else document.addEventListener('DOMContentLoaded', bind, {once:true});
})();
</script>
</body>
</html>
